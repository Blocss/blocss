/*----------------------------------------------------------------------------*\
    $WIDTHS
    Sizes in human readable format. These are used in conjunction with other
    objects and abstractions found in blocss, most commonly the grid system
    and faux flexbox.
\*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*\
    $CONTENTS
\*----------------------------------------------------------------------------*/

    /*
    CONTENTS................You're reading it, LOL
    MIXIN...................There's a mixin fo that
    MODULE..................Includes base module & submodules
    STATE...................States the module can be in
    THEME...................Theming of the module
    */





/*----------------------------------------------------------------------------*\
    $MIXIN
\*----------------------------------------------------------------------------*/

    /**
     * Find the greatest common factor of two integers
     */
    @function gcf($a, $b) {
        @if $b == 0 { @return $a; }
        @else { @return gcf($b, $a % $b); }
    }


    /**
     * Check if a list contains a value
     */
    @function contains($list, $value) {
        @if type-of($list) == list { @return not not index($list, $value); }
        @else { @return $list == $value; }
    }

    /**
     * Fluid units
     * USAGE: provide a space-separated list of integers, each of which
     * represents the number of parts that make up a grid component.
     * Optionally provide a modifier suffix that can be used to adjust
     * grids in different contexts (e.g. viewport dimensions).
     */
    @mixin width-build($units, $modifier: '') {

        /**
         * Proportional units
         * Specify the proportional width of an object.
         * Primarily for, but not limited to, use with `.grid__cell` components.
         * Intentional redundancy build into each set of unit classes.
         */
        @each $n in $units {
            /* Avoid creating rules like '.unit-12-12 {}'' */
            $x: $n - 1;

            @for $i from 1 through $x {
                /* Initialize variables */
                $i-r: ();
                $n-r: ();

                /* Find the greatest common factor */
                $g: gcf($i, $n);

                @if $g > 1 {
                    /* Reduced value of $i */
                    $i-r: $i/$g;
                    /* Reduced value of $n */
                    $n-r: $n/$g;
                }

                /**
                 * Check if the reduced value of $n was also supplied in the
                 * list of units to be built
                 */
                $canreduce: contains($units, $n-r);

                /**
                 * Create units based on fractions
                 */
                .unit-#{$i}-#{$n}#{$modifier} {
                    /**
                     * Ff this unit can be reduced then extend the previous rule
                     */
                    @if $i-r and $canreduce {
                        @extend .unit-#{$i-r}-#{$n-r}#{$modifier};
                    }
                    /**
                     * Otherwise create a new % width
                     */
                    @else {
                        width: percentage($i / $n);
                    }
                }

            } // for $i loop
        } // each unit loop


        /**
         * Full width class
         */
        .unit-1-1#{$modifier}{
            width: 100%;
        }


    } // mixin: width-build;


    /**
     * Fluid push classes
     * USAGE: provide a space-separated list of integers, each of which
     * represents the number of parts that make up a grid component.
     * Optionally provide a modifier suffix that can be used to adjust
     * grids in different contexts (e.g. viewport dimensions).
     */
    @mixin push-build($units, $modifier: '') {

        /**
         * Proportional units
         * Specify the proportional width of an object.
         * Primarily for, but not limited to, use with `.grid__cell` components.
         * Intentional redundancy build into each set of unit classes.
         */
        @each $n in $units {
            /* Avoid creating rules like '.unit-12-12 {}'' */
            $x: $n - 1;

            @for $i from 1 through $x {
                /* Initialize variables */
                $i-r: ();
                $n-r: ();

                /* Find the greatest common factor */
                $g: gcf($i, $n);

                @if $g > 1 {
                    /* Reduced value of $i */
                    $i-r: $i/$g;
                    /* Reduced value of $n */
                    $n-r: $n/$g;
                }

                /**
                 * Check if the reduced value of $n was also supplied in the
                 * list of units to be built
                 */
                $canreduce: contains($units, $n-r);

                /**
                 * Create unit offsets based on fractions
                 */
                .push-#{$i}-#{$n}#{$modifier} {
                    /**
                     * if this offset can be reduced then extend the previous rule
                     */
                    @if $i-r and $canreduce {
                        @extend .push-#{$i-r}-#{$n-r}#{$modifier};
                    }
                    /**
                     * otherwise create a new % margin
                     */
                    @else {
                        margin-#{$grid-direction}: percentage($i / $n);
                    }
                }

            } // for $i loop
        } // each unit loop

    } // mixin: push-build;





/*----------------------------------------------------------------------------*\
    $MODULE
\*----------------------------------------------------------------------------*/

    /**
     * Setup generic widths
     */
    @if $use-generic-widths == true{
        @include width-build($width-divisions);
    } // use-generic-widths


    /**
      * Setup generic push widths
      */
    @if $use-generic-push == true{
        @include push-build($width-divisions);
    }





/*----------------------------------------------------------------------------*\
    $STATE
\*----------------------------------------------------------------------------*/

    @if $responsive == true{
    /* Responsive widths & pushers
    \*------------------------------------------------------------------------*/

        @if $use-generic-widths == true{
            @each $name in $breakpoint-has-widths {
                @include media-query($name) {
                   @include width-build($width-divisions, '--#{$name}');
                }
            }
        }

        @if $use-generic-push == true{
            @each $name in $breakpoint-has-push {
                @include media-query($name) {
                   @include push-build($width-divisions, '--#{$name}');
                }
            }
        }

    } // reponsive





/*----------------------------------------------------------------------------*\
    $THEME
\*----------------------------------------------------------------------------*/